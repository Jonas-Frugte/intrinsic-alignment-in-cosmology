\documentclass[11pt]{article}

\usepackage{jcappub}

\usepackage[utf8]{inputenc}   % Allows UTF-8 character encoding
\usepackage{amsmath}          % For advanced math typesetting
\usepackage{amssymb}          % Additional math symbols
\usepackage{graphicx}         % For including images
\usepackage{hyperref}         % For hyperlinks in the document
\usepackage{geometry}         % For setting up page geometry
\geometry{margin=1in}         % 1-inch margins all around
\usepackage{siunitx}          % For consistent typesetting of units
\usepackage{float}            % To control float positioning (e.g., figures/tables)
\usepackage{enumitem}         % Better control over list formatting
\usepackage{tocloft}
\usepackage{tikz}
\usepackage{tikz-3dplot}
\usetikzlibrary{shapes.geometric, arrows, backgrounds}
\usepackage{empheq}
\usepackage{booktabs}
\usepackage{multirow} % needed for merging cells vertically
\usepackage{booktabs}
\usepackage[table]{xcolor}


\usepackage{listings}
\usepackage{xcolor}
\usepackage{pgfmath}
\newcommand{\greenfactor}[1]{%
    \pgfmathsetmacro{\value}{min(100,round(100*(#1-1)))}%
    \textcolor{green!80!black!\value!black}{#1}%
}


\usepackage[backend=bibtex, sorting=none]{biblatex}
\addbibresource{sources.bib}

% some custom commands that should've already been in latex by default
\DeclareRobustCommand{\d}{\ifmmode\text{d}\else d\fi}
\DeclareRobustCommand{\Cov}{\ifmmode\text{Cov}\else d\fi}
\DeclareRobustCommand{\CMB}{\ifmmode\text{CMB}\else d\fi}
\DeclareRobustCommand{\gal}{\ifmmode\text{gal}\else d\fi}
\DeclareRobustCommand{\tr}{\ifmmode\text{tr}\else d\fi}
\DeclareRobustCommand{\tf}{\ifmmode\text{tf}\else d\fi}

\newcommand{\br}[1]{\ensuremath{\left( #1 \right)}}
\newcommand{\sbr}[1]{\ensuremath{\left[ #1 \right]}}

\setlength{\cftbeforesecskip}{5pt}

% Additional customizations (optional)
\setlength{\parindent}{0pt}   % No paragraph indentation
\setlength{\parskip}{1em}     % Add space between paragraphs
\title{Intrinsic Alignment in Cosmology}

\author[1]{Jonas Frugte}

\affiliation[1]{Van Swinderen Institute for Particle Physics and Gravity, University of Groningen, Nijenborgh 4, 9747 AG Groningen, The Netherlands}

\emailAdd{jonasfrugte@gmail.com}
\abstract{
A brief literature review of intrinsic alignment (IA) in cosmology.
}


\begin{document}

\maketitle
\section*{Abbreviations}
\begin{itemize}
    \item[] EFT: effective field theory
    \item[] BPs: bias parameters
    \item[] IA: intrinsic alignment
    \item[] LIMD: linear in matter density
\end{itemize}

\section{Halo Bias and EFT}
In this section we introduce the much more established field of galaxy bias and an EFT of galaxy bias. This will directly translate to the EFT used in section \ref{sec:galaxyintrinsicalignment}. We consider a $\Lambda$CDM universe with a perturbed FLRW metric unless stated otherwise.

\subsection{What is bias}
Say we look at a the universe at redshift $z$. Given a perturbation to the matter density $\delta(\mathbf x, z)$ we would like to know the perturbation to the density of some other tracer. In this section we will consider the relative number overdensity of dark matter halos, $\delta_h$, but the results are applicable to any tracer in general, notably to galaxy number density. We then model the relation between these two as
\begin{equation}
    \delta_h(\mathbf x, z) = \sum_{\mathcal O} b_{\mathcal O}(z) \mathcal O(\delta)(\mathbf x, z),
\end{equation}
where we sum over some set of operators $\{\mathcal O\}$ that map $\delta$ to a new function of position and time and the $b_{\mathcal O}$ are the BPs. Crucially, they only depend on z and not on $\mathbf x$. 4 questions arise naturally from this model:
\begin{enumerate}
    \item What is the motivation to use this model? Why is this expected to be accurate up to a (reasonably small) scale cutoff with the right choice of operators and values of BPs?
    \item How can we choose a set of operators that is "complete"? I.e. that the model is correct in the sense of the previous question.
    \item How do the bias parameters evolves over time?
    \item How do we determine bias parameters? Both theoretically and empiricially given a dataset from a real life survey or a simulation.
\end{enumerate}
The rest of this section will be devoted to summarizing the answers to these questions.


\subsection{Relating bias parameters from different times}
We consider a simple case where a population of galaxies instantly formed at some time $\tau_*$. This is sufficient because the evolution equations we obtain will then work as a ``Green's function'' for the evolution equations of bias parameters in general. We simply integrate over the time evolved bias parameters weighted by the rate of galaxy formation at the integrand time.

We assume that whatever tracer we consider moves with the fluid. This immediately gives the continuity equation:
\begin{equation}
    \frac{D}{D\tau}\delta_g = -\theta(1+\delta_g),
    \label{eq:conteqtracer}
\end{equation}
where
\begin{equation}
    \frac{D}{D\tau} = \frac{\partial}{\partial \tau} + v^i\frac{\partial}{\partial x^i}
\end{equation}
is the convective time derivative, $v^i$ is the peculiar velocity of the cosmic matter fluid, and $\theta=\partial_i v^i$ is the velocity divergence. % TODO: mention something about assuming no velocity bias?
To evolve $\delta_g$ we also need evolution equations for $\delta$ and $v^i$. They are given by the continuity equation (again)
\begin{equation}
    \frac{D}{D\tau}\delta = -\theta(1+\delta),
    \label{eq:conteq}
\end{equation}
and the Euler equation,
\begin{equation}
    \frac{D}{D\tau}\theta = -\mathcal H \theta - (\partial^iv^j)^2 - \frac{3}{2}\Omega_m\mathcal H^2\delta.
\end{equation}
% TODO: say something about the different ways of solving these eqs?

We proceed by dividing equations \ref{eq:conteq} and \ref{eq:conteqtracer} by $1+\delta$ and $1+\delta_g$, respectively to get
\begin{equation}
    \frac{1}{1+\delta_g}\frac{D}{D\tau}\delta_g = \frac{1}{1+\delta}\frac{D}{D\tau}\delta.
\end{equation}
This can be solved by switching to Lagrangian coordinates to get
\begin{equation}
    \ln (1+\delta_g(\mathbf x (\tau), \tau)) = \ln (1+\delta(\mathbf x (\tau), \tau)) + \ln (\frac{1+\delta_g(\mathbf x (\tau), \tau)}{1+\delta(\mathbf x(\tau), \tau)}), \quad \tau>\tau_*,
\end{equation}
which can be written more simply as
\begin{equation}
    1+\delta_g|_\tau = \frac{1+\delta|_\tau}{1+\delta|_{\tau_*}}(1+\delta_g|_{\tau_*}).
\end{equation}
This equation can be made usefull by expanding order by order. Up to second order we get
\begin{gather}
    1+\delta_g^{(1)}(\mathbf x, \tau) + \delta_g^{(2)}(\mathbf x, \tau) = 1+\delta^{(1)}-\delta^{(1)}_* + \delta_{g*}^{(1)}+\delta^{(2)}-\delta{(2)}_*+\delta_{g*}^{(2)}+[\delta_*^{(1)}]^2-\delta^{(1)}\delta^{(1)}_*+\sbr{\delta^{(1)}-\delta_*^{(1)}}\delta_{g*}^{(1)}.
\end{gather}
Now, the difference between $\mathbf x$ and $\mathbf x_*$ is first order in perturbations as well. We can Taylor expand around $\mathbf x$ and use that the displacement, $\mathbf x - \mathbf x_*$ evolves according to the growth factor $D$ to get
\begin{align}
    \delta^{(1)}_g(x,\tau) &= \left( 1 + \frac{D_*}{D}\,[b_1^* - 1] \right) 
       \delta^{(1)}(x,\tau) + \varepsilon^* \\[6pt]
    \delta^{(2)}_g(x,\tau) &= \left\{ 1 + [b_1^* - 1] \left(\frac{D_*}{D}\right)^2 \right\}\delta^{(2)} 
       + \left\{ \frac{D_*}{D}[b_1^* - 1] - \left(\frac{D_*}{D}\right)^2[b_1^* - 1] 
       + \tfrac{1}{2} b_2^* \left(\frac{D_*}{D}\right)^2 \right\} [\delta^{(1)}]^2 \\[6pt]
       &\quad + b_K^{*2}\left(\frac{D_*}{D}\right)^2 [K^{(1)}_{ij}]^2
       + \left(\frac{D_*}{D} - 1\right)\frac{D_*}{D}[b_1^* - 1]\,s_{(1)}^i \partial_i \delta^{(1)}
       - \left(\frac{D_*}{D} - 1\right)\varepsilon^* \delta^{(1)} \\[6pt]
       &\quad + \left(\frac{D_*}{D} - 1\right) s_{(1)}^i \partial_i \varepsilon^* \,.
\end{align}
Here, $\varepsilon$ is a stochastic parameter added in and $s^i=x^i-x^i_*$ is the displacement. One can then extract the bias parameters at current time (Eularian time) by comparing to the bias expansion at Eularian time and matching terms to get
\begin{align}
    b_1^E &= 1 + \frac{D_*}{D}(b^*_1-1) \\
    b_2^E &= b_2^* \br{\frac{D_*}{D}}^2 + \frac{8}{21}\br{1-\frac{D_*}{D}}(b_1^E-1) \\
    b_{K^2}^E &= b^*_{K^2} \br{\frac{D_*}{D}}^2 - \frac{2}{7}\br{1-\frac{D_*}{D}}(b_1^E-1)
\end{align}
Clearly this can be easily generalized to any order.


\subsection{EFT of bias parameters}
%TODO: explain lagrangian and eularian space
Main ref: \cite{Desjacques_2018}
We would like to find a "basis" of bias parameters up to a given order in perturbation theory. We will assume that (1) gravitation is described by general relativity, (2) that we can neglect the impact of massive neutrinos and dark energy perturbations, (3) that initial conditions are Gaussian and adiabatic.

We will assume that the only quantities relevant for the formation of galaxies are local on some scale $R_*$ which is much larger than the size of a galaxy. According to the equivalence principle, the only effects that can be measured by a freely falling observer (i.e. forming galaxy) is the second derivatives of the gravitational potential, $\partial_i \partial_j \Phi$. Higher derivatives will be higher order contributions, because each derivative on a scale of $R_*$ contributes a factor of $k/R_*$, which for large enough scales will be much smaller than one.

Now, the galaxy density, $\delta_g$ %TODO: give proper def of delta_g
will in a very general sense depend on the history of $\partial_i \partial_j \Phi$ along the fluid trajectory. In other words:
\begin{equation}
    \partial_g(\mathbf x, \tau) \supset \int^\tau d\tau'f_{\mathcal O }(\tau, \tau') \mathcal O (\mathbf x_{fl}(\tau'), \tau'),
\end{equation}
where $f_O$ is some kernel that we don't need to bother defining. %TODO: is there anything more we can say about it?
We can then Taylor expand to get
\begin{equation}
    \partial_g(\mathbf x, \tau) \supset \sbr{\int^\tau d\tau'f_{\mathcal O }(\tau, \tau')} \mathcal O (\mathbf x_{fl}(\tau), \tau) + \sbr{\int^\tau d\tau' (\tau'-\tau) f_{\mathcal O }(\tau, \tau')} \frac{D}{D\tau}\mathcal O (\mathbf x_{fl}(\tau), \tau) + \cdots,
\end{equation}
where $D/D\tau$ is the convective derivative along the fluid flow. %tTODO: give mathematical definition 
In order to define a basis we thus also have to include time derivatives $D/D\tau$ of the second derivatives of the potential. It now seems like we would need an infinite set of operators to form a basis. This can be avoided by noticing at finite order in perturbation theory, only a finite amount of these operators are linearly independent of one another.

In order to show the above statement, we will first switch to Lagrangian coordinates $\mathbf q = \mathbf x_{fl}(\tau=0)$ where the convective time derivative simplifies to $\partial/\partial \tau$. We also assume that the $n$-th order growth factor is given by the linear growth factor to the $n$-th power. This is only strictly valid for an EdS (flat matter dominated universe) but is still very accurate for other cosmologies such as $\Lambda$ CDM. % TODO: when are you even allowed to use a growth factor? check this
Consider some operator in the basis, $O_L(\mathbf q, \tau)$ which has contributions at various orders, $O_L^i(\mathbf q, \tau)$, then
\begin{equation}
    \br{\frac{D}{D\tau}}^n O_L(\mathbf q, \tau)|^{(n)} = \br{\frac{\partial}{\partial\tau}}^n O_L(\mathbf q, \tau)|^{(n)} = \sum_{i = 1}^n \br{\frac{d^n}{d\tau^n}D^i(\tau)}O^{i}_{L}(\mathbf q, \tau_0).
\end{equation}

Next, although higher order contributions start being linearly dependent on the lower order contributions after some order, as shown above, it is worth noting that these higher order contributions are in general no longer local in $\partial_i\partial_j \phi$. This is immediately obvious if we notice that the convective time derivative contains a spatial derivative that generates higher order ($k/R_*$) terms. It turns out that, due to symmetry requirements, we only need to consider $\partial_i \partial_j / \nabla ^2$ acting on powers of $\partial_k \partial_l \Phi$ in order to get all the new terms created by the extra spatial derivatives. % TODO: find a proper proof of this, "Large Scale Galaxy Bias" just kind of brushes over this imo, can check out McDonald & Roy (2009) and Desjacques, Jeong & Schmidt, Large-Scale Galaxy Bias (2018)

Constructing a Eularian basis out of $\partial_i\partial_j\Phi(\mathbf x, \tau)$ and its convective time derivatives can be done explicitly as follows. First define
\begin{equation}
    \Pi^{[1]}_{ij}(\mathbf x, \tau) = \frac{2}{3\Omega_m\mathcal H^2}\partial_i\partial_j\Phi(\mathbf x, \tau) = K_{ij}(\mathbf x, \tau) + \frac{1}{3}\delta_{ij}\delta(\mathbf x, \tau)
\end{equation}
and
\begin{equation}
    \Pi^{[n]}_{ij} = \frac{1}{(n-1)!}\sbr{ \frac{1}{\mathcal H f}\frac{D}{D\tau} \Pi^{[n-1]}_{ij} - (n-1)\Pi^{[n-1]}_{ij}},
\end{equation}
as given by ref. \cite{Mirbabayi_2015}. Then take into account that $\tr \Pi^{[n]}$ can be written in terms of lower order operators through the Eularian fluid equations. % TODO: introduce/discuss them very briefly

To get all terms at order $n$, we then write products of $\Pi^{[k]}$ where $k<n$ and the total order adds up to $n$ or less and take traces of the different possible combinations of each product. %TODO: describe this better somehow

\section{Spin-2 Fields and Their Projections}
It is well known how to construct powerspectra from scalar quantities. Constructing them for a spin-2 field requires more care. In particular, we would like to find a way to define powerspectra that is independent of the orientation of the observer.

We model galaxies in 3D space as ellipsoids where we do not care about the overal size. This means they can be described according to the $3 \times 3$ symmetric trace-free tensor $Q_{ij}$ given by
\begin{equation}
    Q_{ij} = \tf\br{\frac{\int \d^3 x \rho(\mathbf x) x^i x^j}{\int\d^3 x \rho(\mathbf x)}},
\end{equation}
where we assume for simplicity that the galaxy's center of mass is at $x^i=0$ and $\tf (\cdot)$ means taking the trace free part. The trace corresponds to the overal size of the galaxy and is not of interest to us. This corresponds roughly to $g_{ij}$ from \cite{bakx2023effectivefieldtheoryintrinsic}.
$Q_{ij}$ at some point can transform under SO(3). Specifically, it transforms under the spin-2 representation, which can immediately be seen because $Q_{ij}$ is a 5 dimensional vector space and there is only one irreducible representation of SO(3) of dimension $2\ell + 1$, with in this case $\ell = 2$. This is the classification theorem. %TODO: give citation
Alternatively, it is clear that under a SO(3) rotation given by $R$, we get $Q_{ij} \rightarrow R_{ia}R_{jb}Q_{ab}$. One can compare this to the spin-2 representation of SO(3) to see that they are the same. %TODO: find source?

We observe shapes as projected onto the sky. If we take $\mathbf n$ as our line of sight with associated projection matrix $P^{ij}$, then
\begin{gather}
    \gamma_{ij} := \tf_P\br{P^{ik}P^{jl}g_{kl}(\mathbf x, z)}\\
                = \frac{1}{2}\br{P^{ik}P^{jl} + P^{il}P^{jk} - P^{ij}P^{kl}}g_{kl}(\mathbf x, z)\\
                =: P^{ijkl}g_{kl}(\mathbf x, z).
\end{gather}
In the last line we simply define $P^{ijkl}$ as the combination of $P^{ij}$ from the line above. Going from line 1 to line 2 follows by using that in the projected space, the metric is $P^{ij}$ instead of $\delta^{ij}$ and the trace of an arbitrary tensor $M_{ij}$ thus becomes $P^{ij}M_{ij}$. % TODO: explain better why this is, because I'm not 100 percent convinced of this myself

$\gamma_{ij}$ is again symmetric, trace-free, and transforms like a spin-2 representation, now of SO(2).

\subsection{Spherical tensor decomposition}
Going back to the non-projected $Q_{ij}$, it's clear that this tensor is defined at each point in space, $\mathbf x$. Now look at the Fourier transform, $Q_{ij}(\mathbf k)$. For a mode in a given direction, $\hat{\mathbf k}$, we can decompose $Q_{ij}(\mathbf k)$ through the spherical tensors $(Y_2^{(m)})(\hat{\mathbf k})_{ij}$, with $m=-2, -1, 0, 1, 2$ denoting the helicity. %TODO: add source
We get
\begin{align}
    (Y_2^{(0)})(\hat{\mathbf k})_{ij} &= \sqrt{3/2}(\hat{\mathbf k}_i\hat{\mathbf k}_j - \frac{1}{3}\delta_{ij})\\
    (Y_2^{(\pm 1)})(\hat{\mathbf k})_{ij} &= \sqrt{1/2}(\hat{\mathbf k}_i\mathbf e_j^\pm + \hat{\mathbf k}_j\mathbf e_i^\pm)\\
    (Y_2^{(\pm 1)})(\hat{\mathbf k})_{ij} &= \mathbf e_i^\pm \mathbf e_j^\pm
\end{align}
with $e^{\pm}=...$%TODO
and $i,j=1,2,3$. The unit vectors $e_1$ and $e_2$ are defined by $...$ %TODO
For a rotation around $\hat{\mathbf k}$ by an angle $\phi$ the spherical tensors transform as
$$
(Y_2^{(m)})(\hat{\mathbf k})_{ij} \rightarrow e^{im\phi}(Y_2^{(m)})(\hat{\mathbf k})_{ij}.
$$
These spherical tensors have a number of other usefull properties which we will not get into right now. 

\subsection{Defining Power Spectra}
We can now define the powerspectrum as a $3 \times 3 \times 3 \times 3$ tensor given by
\begin{equation}
    \langle Q_{ij}(\mathbf k)Q_{ij}(\mathbf k') = (2 \pi)^3\delta^D(\mathbf k + \mathbf k')P_{ijkl}^{QQ}(\mathbf k).
\end{equation}
This definition is the most obvious, however because $Q_{ij}$ transforms as a tensor under rotations, it leaves $P_{ijkl}^{QQ}(\mathbf k)$ dependent on the direction of $\mathbf k$. We can instead work with the decomposition of $Q_{ij}$ in the spherical tensors:
\begin{equation}
    Q_{ij}(\mathbf k) = \frac{1}{3}\delta_{ij}Q_0^0(\mathbf k) + \sum_{m=-2}^2Q_2^m(\mathbf k)Y_{ij}^{(m)}(\hat{\mathbf k}),
\end{equation}
where we now allow $Q_{ij}$ to also have a trace / scalar component $Q_0^0$. % TODO: this transition is a bit abrupt, should make this the case from the start
We can then define the following powerspectra:
\begin{equation}
    \langle S_l^{(m)}(\mathbf k)S_{l'}^{(m')}(\mathbf k')\rangle = (2\pi)^3\delta_{mm'}\delta^D(\mathbf k + \mathbf k')P^{(m)}_{ll'}(k).
\end{equation}
When the powerspectra are defined in this way, they are scalars. There are 7 independent spectra, however we also have by the properties of the spherical tensors that
\begin{equation}
    P_{ll'}^{(m)}(k)^*=P_{ll'}^{(-m)}(k).
\end{equation}
If we also enfore invariance under parity transformations, then we find that the powerspectra are real and thus that
\begin{equation}
    P^{(m)}_{ll'}(k)=P^{(-m)}_{ll'}(k).
\end{equation}
This reduces the amount of independent spectra to 5. % Don't you also get this if there's no parity invariance? this part is a bit sketch ngl





\section{Galaxy Intrinsic Alignment}
\label{sec:galaxyintrinsicalignment}



\printbibliography

\end{document}